version: "2"

services:

  web:
    build: "./web"
    ports:
      - "80:80"
    # For development we compile the .ts
    # externally and map the volume.
    volumes:
      - "./web/html:/app"
    depends_on:
      - "api"

  api:
    build: "./api"
    expose:
      - "80"
    ports:
      - "81:80"
    depends_on:
      - "mongo"
      - "redis"

  worker:
    build: "./worker"
    depends_on:
      - "mongo"
      - "redis"

  redis:
    image: "redis:3.2.5"
    expose:
      - "80"

  mongo:
    image: "mongo:3.2.11"
    expose:
      - "27017"